<script>
  var xhr = new XMLHttpRequest();
  var url = "https://script.google.com/macros/s/AKfycbwAdHQKh2xvieyPqFPylLVH7GlhFPE_LL81447HNSC_LZuRbh03YMWFblnmngSxU2jGpQ/exec?u=";
  var r = (location.pathname.slice(-1) == "+");
  if(r){
    url += location.pathname.slice(1).slice(-1) + "&t=r"
  } else{
    url += location.pathname.slice(1);
  }
  xhr.open("GET", url, false);
  xhr.onreadystatechange = function(){
    if (xhr.readyState === 4 && xhr.status === 200){
      var res = xhr.responseText;
      if(res == "error"){
        document.write("<p>このリンクは存在しません</p>");
      } else if(r){
        document.write("<p>" + res + "</p>");
      } else{
        location.replace(res);
      }
    }
  };
  xhr.send(null);
</script>
